# Создание собственного плагина

<!-- TOC -->

- [Создание собственного плагина](#создание-собственного-плагина)
  - [Пример создания нового плагина из шаблона](#пример-создания-нового-плагина-из-шаблона)
  - [Пример вызова плагина из теста](#пример-вызова-плагина-из-теста)

<!-- /TOC -->

В каталоге doc/PluginsTemplates/ШаблонУтилиты находятся исходники шаблона необходимой обработки.

## Пример создания нового плагина из шаблона

 - Открыть в конфигураторе шаблон обработки - утилиты 
 - В модуле объекта в методе ОписаниеПлагина закомментировать исключение и добавить собственное представление плагина, например, "Работа с массивами"

``` bsl 

Перем ПутьКФайлуПолный Экспорт;// в эту переменную будет установлен правильный клиентский путь к текущему файлу

// { Plugin interface
Функция ОписаниеПлагина(ВозможныеТипыПлагинов) Экспорт
	Результат = Новый Структура;
	Результат.Вставить("Тип", ВозможныеТипыПлагинов.Утилита);
	Результат.Вставить("Идентификатор", Метаданные().Имя);
	Результат.Вставить("Представление", "Работа с массивами");
	// ВызватьИсключение "Необходимо указать представление";
	
	Возврат Новый ФиксированнаяСтруктура(Результат);
КонецФункции

Процедура Инициализация(КонтекстЯдраПараметр) Экспорт
КонецПроцедуры
// } Plugin interface


```
- Добавляем экспортный метод в модуль объекта, например, ЗначениеВМассиве

``` bsl 

// Создает массив и помещает в него переданное значение.
//
// Параметры:
//  Значение - Произвольный - любое значение.
//
// Возвращаемое значение:
//  Массив - массив из одного элемента.
//
Функция ЗначениеВМассиве(Значение) Экспорт
	
	Массив = Новый Массив;
	Массив.Добавить(Значение);
	
	Возврат Массив;
	
КонецФункции

```
- Добавить экспортный клиентский метод в модуле формы.

``` bsl

&НаКлиенте
Функция ЗначениеВМассиве(Значение)  Экспорт 
	
	Массив = Новый Массив;
	Массив.Добавить(Значение);
	
	Возврат Массив;
	
КонецФункции

```

- Cохранить обработку с именем РаботаСМассивами.epf, в каталоге C:\Program Files\OneScript\lib\add\plugins

## Пример вызова плагина из теста

``` bsl 

//{ основная процедура для юнит-тестирования xUnitFor1C
Процедура Инициализация(КонтекстЯдраПараметр) Экспорт
	
  КонтекстЯдра = КонтекстЯдраПараметр;
	// инициализация собственного плагина
  РаботаСМассивами = КонтекстЯдра.Плагин("РаботаСМассивами");

КонецПроцедуры

Процедура ЗаполнитьНаборТестов(НаборТестов, КонтекстЯдраПараметр) Экспорт
  
  КонтекстЯдра = КонтекстЯдраПараметр;
  НаборТестов.НачатьГруппу("Группа тестов");
  НаборТестов.Добавить("ТестДолжен_ДобавитьЗначениеВМассив");

КонецПроцедуры

Процедура ТестДолжен_ДобавитьЗначениеВМассив

  ДобавляемоеЗначение = 1;
  МассивСоЗначением = РаботаСМассивами.ЗначениеВМассиве(ДобавляемоеЗначение);
	
  Ожидаем.Что(МассивСоЗначением)
  		.ИмеетТип(Тип("Массив"));

	Ожидаем.Что(МассивСоЗначением.Количество())
	    .Равно(1);

КонецПроцедуры

```
